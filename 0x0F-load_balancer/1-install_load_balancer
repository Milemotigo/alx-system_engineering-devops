#!/usr/bin/env bash
# HAproxy load balancer configurations for my 2 webservers

sudo echo "
ENABLE=1" | sudo tee -a /etc/default/haproxy

sudo cp /etc/haproxy/haproxy.cfg /etc/haproxy/haproxy.cfg.real.cfg

echo "
frontend 222472-lb-01
        mode http
        bind *:80
        default_backend web_servers

backend web_servers
        balance roundrobin
        server 222472-web-01 3.83.18.183:80 check
        server 222472-web-02 54.157.166.238:80 check" | sudo tee -a /etc/haproxy/haproxy.cfg

sudo service haproxy start
sudo service haproxy restart
